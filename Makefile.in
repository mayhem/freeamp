# Freeamp master Makefile
# $Id: Makefile.in,v 1.24.4.3 1999/05/20 01:22:03 dogcow Exp $

FPIC=
# RELOC = null for freeamp main; RELOC = @FPIC@ for plugins.

include config/Makefile.header

FREEAMPunixOBJ  = base/unix/src/bootstrap.o base/unix/src/unixprefs.o
FREEAMPunixOBJ += base/unix/src/win32impl.o

FREEAMPsolarisOBJ  = base/unix/solaris/src/solaristhread.o
FREEAMPsolarisOBJ += base/unix/solaris/src/debug.o
FREEAMPsolarisOBJ += base/unix/solaris/src/mutex.o
FREEAMPsolarisOBJ += base/unix/solaris/src/semaphore.o
FREEAMPsolarisOBJ += base/unix/solaris/src/utility.o $(FREEAMPunixOBJ)

FREEAMPlinuxOBJ  = base/unix/linux/src/linuxthread.o
FREEAMPlinuxOBJ += base/unix/linux/src/debug.o
FREEAMPlinuxOBJ += base/unix/linux/src/mutex.o
FREEAMPlinuxOBJ += base/unix/linux/src/semaphore.o
FREEAMPlinuxOBJ += base/unix/linux/src/utility.o $(FREEAMPunixOBJ)

FREEAMPOBJ =  base/src/hashtable.o base/src/log.o base/src/player.o
FREEAMPOBJ += base/src/playlist.o base/src/propimpl.o base/src/registrar.o
FREEAMPOBJ += base/src/registry.o base/src/thread.o io/src/eventbuffer.o
FREEAMPOBJ += base/src/prefixprefs.o base/src/preferences.o
FREEAMPOBJ += io/src/pmiregistry.o io/src/pmoregistry.o
FREEAMPOBJ += io/src/pullbuffer.o io/src/streambuffer.o
FREEAMPOBJ += lmc/src/lmcregistry.o ui/src/uiregistry.o
FREEAMPOBJ += $(FREEAMP$(HOST_OS)OBJ)
#FREEAMPOBJ += $(OSDEPOBJ)

all: freeamp plugins

freeamp: $(FREEAMPOBJ) $(freeamp_DEPENDENCIES)
	@rm -f freeamp
	$(CXXLINK) $(FREEAMPOBJ) $(LDFLAGS) -ldl -lpthread $(X_LIBS) $(X_EXTRA_LIBS)

clean: freeamp-clean plugins-clean

clean-freeamp freeamp-clean:
	-rm -f $(FREEAMPOBJ) freeamp

plugins: plugins-cc

plugins-cc install-plugins clean-plugins plugins-install plugins-clean:
	+$(PIMAKE) $@

distclean: clean
	-rm -f config.status Makefile config.cache

install: install-freeamp install-plugins

install-freeamp: freeamp
	$(mkinstalldirs) $(DESTDIR)$(bindir)
	$(INSTALL_PROGRAM) freeamp $(DESTDIR)$(bindir)

