# Freeamp master Makefile
# $Id: Makefile.in,v 1.30.2.7 1999/09/20 19:49:11 robert Exp $

FPIC=
# RELOC = null for freeamp main; RELOC = @FPIC@ for plugins.

include config/Makefile.header

GDBMOBJ  = lib/gdbm/bucket.o lib/gdbm/falloc.o lib/gdbm/findkey.o
GDBMOBJ += lib/gdbm/gdbmclose.o lib/gdbm/gdbmdelete.o lib/gdbm/gdbmerrno.o
GDBMOBJ += lib/gdbm/gdbmexists.o lib/gdbm/gdbmfdesc.o lib/gdbm/gdbmfetch.o
GDBMOBJ += lib/gdbm/gdbmopen.o lib/gdbm/gdbmreorg.o lib/gdbm/gdbmseq.o
GDBMOBJ += lib/gdbm/gdbmsetopt.o lib/gdbm/gdbmstore.o lib/gdbm/gdbmsync.o
GDBMOBJ += lib/gdbm/global.o lib/gdbm/hash.o lib/gdbm/update.o
GDBMOBJ += lib/gdbm/version.o

FREEAMPunixOBJ  = base/unix/src/bootstrap.o base/unix/src/unixprefs.o
FREEAMPunixOBJ += base/unix/src/win32impl.o

FREEAMPsolarisOBJ  = base/unix/solaris/src/solaristhread.o
FREEAMPsolarisOBJ += base/unix/solaris/src/debug.o
FREEAMPsolarisOBJ += base/unix/solaris/src/mutex.o
FREEAMPsolarisOBJ += base/unix/solaris/src/semaphore.o
FREEAMPsolarisOBJ += base/unix/solaris/src/utility.o $(FREEAMPunixOBJ)

FREEAMPlinuxOBJ  = base/unix/linux/src/linuxthread.o
FREEAMPlinuxOBJ += base/unix/linux/src/debug.o
FREEAMPlinuxOBJ += base/unix/linux/src/mutex.o
FREEAMPlinuxOBJ += base/unix/linux/src/semaphore.o
FREEAMPlinuxOBJ += base/unix/linux/src/utility.o $(FREEAMPunixOBJ)

FREEAMPbeosOBJ  = base/beos/src/beosprefs.o base/beos/src/beosthread.o
FREEAMPbeosOBJ += base/beos/src/bootstrap.o base/beos/src/debug.o 
FREEAMPbeosOBJ += base/beos/src/mutex.o base/beos/src/semaphore.o 
FREEAMPbeosOBJ += base/beos/src/utility.o
FREEAMPbeosOBJ += base/beos/src/win32impl.o

FREEAMPOBJ =  base/src/log.o base/src/player.o base/src/musicbrowser.o
FREEAMPOBJ += base/src/playlist.o base/src/propimpl.o base/src/registrar.o
FREEAMPOBJ += base/src/registry.o base/src/thread.o io/src/eventbuffer.o
FREEAMPOBJ += base/src/prefixprefs.o base/src/preferences.o
FREEAMPOBJ += base/src/utility.o base/src/database.o base/src/downloadmanager.o
FREEAMPOBJ += io/src/pullbuffer.o io/src/streambuffer.o io/src/tstream.o
FREEAMPOBJ += $(FREEAMP$(HOST_OS)OBJ)
FREEAMPOBJ += $(GDBMOBJ)
#FREEAMPOBJ += $(OSDEPOBJ)

all: freeamp plugins

#CYGWINFREEAMPLIBS =
UNIXFREEAMPLIBS = -ldl -lpthread $(X_LIBS) $(X_EXTRA_LIBS) $(EXTRALIBS)
BEOSFREEAMPLIBS = -lbe -lroot

FREEAMPLIBS = $($(OSTYPE)FREEAMPLIBS)

freeamp: $(FREEAMPOBJ) $(freeamp_DEPENDENCIES)
	@rm -f freeamp
	$(CXXLINK) $(FREEAMPOBJ) $(LDFLAGS) -ldl -lpthread $(X_LIBS) $(X_EXTRA_LIBS) $(EXTRALIBS)

clean: freeamp-clean plugins-clean

clean-freeamp freeamp-clean:
	-rm -f $(FREEAMPOBJ) freeamp

plugins: plugins-cc

plugins-cc install-plugins clean-plugins plugins-install plugins-clean:
	+test -d plugins || mkdir plugins
	+$(PIMAKE) $@

distclean: clean
	-rm -f config.status Makefile config.cache config/config.h
	-rm -f config/Makefile.header

install: install-freeamp install-plugins

install-freeamp: freeamp
	$(mkinstalldirs) $(DESTDIR)$(bindir)
	$(INSTALL_PROGRAM) freeamp $(DESTDIR)$(bindir)

depend:
	makedepend -- $(DEFS) $(INCLUDES) $(CFLAGS) -- `echo $(FREEAMPOBJ) | sed -e 's,\.o,.cpp,g'`
	+$(PIMAKE) depend

Makefile: Makefile.in Makefile-plugins.in
	./config.status
	echo 'Makefile has been rebuilt; please run `make` again.'


#Makefile: configure.in configure
#	./config.status --recheck
#	./config.status
#	make -$(MAKEFLAGS)

# DO NOT DELETE THIS LINE -- make depend depends on it.

